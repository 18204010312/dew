[[devops-user-manual]]
=== DevOps使用手册[TBD]

NOTE: ``Dew`` DevOps部分的核心是由 ``dew-maven-plugin`` 实现。

[[devops-user-manual-import]]
==== 引入方式

===== 使用 ``Dew Framework``

如果您的项目使用 ``Dew Framework`` 构建则只要确保引入了 ``parent-starter`` 即可。

===== 不使用 ``Dew Framework``

``Dew DevOps`` 完全可以独立于 ``Dew Framework`` 使用，只需要在项目的父POM中加上如下配置即可。

[source,xml]
----
<profile>
    <id>devops</id>
    <build>
        <plugins>
            <plugin>
                <groupId>ms.dew</groupId>
                <artifactId>dew-maven-plugin</artifactId>
                <!--生产环境请选择合适的版本!-->
                <version>${dew.version}</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>init</goal>
                            <goal>prepare</goal>
                            <goal>build</goal>
                            <goal>release</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</profile>
----

==== 支持的项目类型

==== 项目配置

Maven配置

脚本使用

==== 打包与部署

重用版本

==== 版本回滚

==== 版本卸载

==== 日志查看

==== 伸缩扩展

==== CI/CD工具支持-Gitlab CI

通过分支变更触发

删除

==== 执行通知

. 钉钉 只支持markdown格式的钉钉消息

. HTTP 数据结构分为以下几种情况

PROCESS_EMPTY(空项目)
----
{
	"title": "DevOps process successful",      # 消息标题
	"content": {                               # 消息内容
		"kind": "PROCESS_EMPTY",               # 过程处理类型
		"ci": "",                              # ci操作
		"message": {}                          # 消息结果内容
	}
}
----
PROCESS_INIT(初始化)
----
{
	"title": "DevOps process successful",      # 消息标题
	"content": {                               # 消息内容
		"kind": "PROCESS_EMPTY",               # 过程处理类型
		"ci": "",                              # ci操作
		"message": {                           # 消息结果内容
			"profile": "uat",                  # 分支或者环境
			"project": "todo-parent",          # 项目名称
		}
	}
}
----
PROCESS_INIT(初始化)
----
{
	"title": "DevOps process successful",      # 消息标题
	"content": {                               # 消息内容
		"kind": "PROCESS_INIT",                # 过程处理类型
		"ci": "",                              # ci操作
		"message": {                           # 消息结果内容
			"mojoName": "release",             # mvn操作步骤
			"profile": "uat",                  # 分支或者环境
			"project": "todo-parent",          # 项目名称
			"successfulFlag": "Successful",    # 成功标识
			"group": "ms.dew.devops.it",       # 项目group名称
			"message":"***",                   # 错误信息
			"throwable":"**"                   # 错误
		}
	}
}
----
PROCESS_EXECUTE_SUCCESS(成功)/PROCESS_EXECUTE_FAILURE(失败)
----
{
	"title": "DevOps process successful",         # 消息标题
	"content": {                                  # 消息内容
		"kind": "PROCESS_EXECUTE_SUCCESS",        # 过程处理类型
		"ci": "",                                 # ci操作
		"message": {                              # 消息结果内容
			"mojoName": "release",                # mvn操作步骤
            "profile": "uat",                     # 分支或者环境
            "project": "todo-parent",             # 项目名称
            "successfulFlag": "Successful",       # 成功标识
            "group": "ms.dew.devops.it",          # 项目group名称
            "message":"***",                      # 错误信息
            "throwable":"**"                      # 错误
		}
	}
}
----
PROCESS_GLOBAL_ERROR(全局错误)
----
{
	"title": "DevOps process successful",         # 消息标题
	"content": {                                  # 消息内容
		"kind": "PROCESS_EXECUTE_SUCCESS",        # 过程处理类型
		"ci": "",                                 # ci操作
		"message": {                              # 消息结果内容
			"error": "release",                   # 错误信息
            "errorStackTrace": "uat"              # 错误堆栈信息
		}
	}
}
----
PROCESS_SHUTDOWN(关闭)
----
{
	"title": "DevOps process successful",         # 消息标题
	"content": {                                  # 消息内容
		"kind": "PROCESS_EXECUTE_SUCCESS",        # 过程处理类型
		"ci": "",                                 # ci操作
		"message": {                              # 消息结果内容
			"successfulExecProjects": {           # 成功项目
			    "project":"todo-kernel",          # 项目名称
			    "reason":""
			},
			"failureExecProjects": {              # 失败项目
			    "project":"todo-kernel",          # 项目名称
			    "reason":"**"                     # 失败原因
			},
			"noneExecProjects": {                 # 未执行项目
			    "project":"todo-kernel",          # 项目名称
			    "reason":"**"                     # 未执行原因
			},
			"ignoreExecProjects": {               # 忽略执行项目
			    "project":"todo-kernel",          # 项目名称
			    "reason":"**"                     # 忽略原因
			},
		}
	}
}
----













